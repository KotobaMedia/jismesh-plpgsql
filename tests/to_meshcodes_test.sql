BEGIN;
SELECT plan(1);

CREATE TABLE meshcodes AS (
    SELECT meshcode, ST_AsText(geom) as "geom" FROM jismesh.to_meshcodes(
        ST_SetSRID(ST_MakeBox2D(
            ST_MakePoint(139.745433, 35.658581),
            ST_MakePoint(135.759363, 34.987574)
        ), 4326),
        'Lv1'::jismesh.mesh_level
    )
);

SELECT results_eq(
    'SELECT * FROM meshcodes ORDER BY meshcode',
    $$VALUES
        (5235::bigint, 'POLYGON((135 34.666666666666664,136 34.666666666666664,136 35.33333333333333,135 35.33333333333333,135 34.666666666666664))'),
        (5236::bigint, 'POLYGON((136 34.666666666666664,137 34.666666666666664,137 35.33333333333333,136 35.33333333333333,136 34.666666666666664))'),
        (5237::bigint, 'POLYGON((137 34.666666666666664,138 34.666666666666664,138 35.33333333333333,137 35.33333333333333,137 34.666666666666664))'),
        (5238::bigint, 'POLYGON((138 34.666666666666664,139 34.666666666666664,139 35.33333333333333,138 35.33333333333333,138 34.666666666666664))'),
        (5239::bigint, 'POLYGON((139 34.666666666666664,140 34.666666666666664,140 35.33333333333333,139 35.33333333333333,139 34.666666666666664))'),
        (5335::bigint, 'POLYGON((135 35.33333333333333,136 35.33333333333333,136 35.99999999999999,135 35.99999999999999,135 35.33333333333333))'),
        (5336::bigint, 'POLYGON((136 35.33333333333333,137 35.33333333333333,137 35.99999999999999,136 35.99999999999999,136 35.33333333333333))'),
        (5337::bigint, 'POLYGON((137 35.33333333333333,138 35.33333333333333,138 35.99999999999999,137 35.99999999999999,137 35.33333333333333))'),
        (5338::bigint, 'POLYGON((138 35.33333333333333,139 35.33333333333333,139 35.99999999999999,138 35.99999999999999,138 35.33333333333333))'),
        (5339::bigint, 'POLYGON((139 35.33333333333333,140 35.33333333333333,140 35.99999999999999,139 35.99999999999999,139 35.33333333333333))')
    $$
);

SELECT * FROM finish();
ROLLBACK;
